{"version":3,"sources":["components/Callout/CalloutContent.tsx"],"names":[],"mappings":"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","file":"components/Callout/CalloutContent.js","sourcesContent":["/* tslint:disable:no-unused-variable */\nimport * as React from 'react';\n/* tslint:enable:no-unused-variable */\nimport { ICalloutProps } from './Callout.Props';\nimport { DirectionalHint } from '../../common/DirectionalHint';\nimport {\n  autobind,\n  css,\n  elementContains\n} from '../../Utilities';\nimport { getRelativePositions, IPositionInfo } from '../../utilities/positioning';\nimport { focusFirstChild } from '../../utilities/focus';\nimport { Popup } from '../Popup/index';\nimport { BaseComponent } from '../../common/BaseComponent';\nimport './Callout.scss';\n\nconst BEAK_ORIGIN_POSITION = { top: 0, left: 0 };\nconst OFF_SCREEN_POSITION = { top: -9999, left: 0 };\n\nexport interface ICalloutState {\n  positions?: any;\n  slideDirectionalClassName?: string;\n  calloutElementRect?: ClientRect;\n}\n\nexport class CalloutContent extends BaseComponent<ICalloutProps, ICalloutState> {\n\n  public static defaultProps = {\n    isBeakVisible: true,\n    beakStyle: 'ms-Callout-beak',\n    beakWidth: 28,\n    gapSpace: 0,\n    directionalHint: DirectionalHint.bottomAutoEdge\n  };\n\n  private _didSetInitialFocus: boolean;\n  private _hostElement: HTMLDivElement;\n  private _calloutElement: HTMLDivElement;\n  private _targetWindow: Window;\n\n  constructor(props: ICalloutProps) {\n    super(props);\n\n    this._didSetInitialFocus = false;\n    this.state = {\n      positions: null,\n      slideDirectionalClassName: null,\n      calloutElementRect: null\n    };\n    // This is used to allow the Callout to appear on a window other than the one the javascript is running in.\n    if (props.targetElement && props.targetElement.ownerDocument && props.targetElement.ownerDocument.defaultView) {\n      this._targetWindow = props.targetElement.ownerDocument.defaultView;\n    } else {\n      this._targetWindow = window;\n    }\n  }\n\n  public componentDidUpdate() {\n    this._setInitialFocus();\n    this._updatePosition();\n  }\n\n  public componentDidMount() {\n    this._onComponentDidMount();\n  }\n\n  public render() {\n    let { className, targetElement, isBeakVisible, beakStyle, children } = this.props;\n    let { positions, slideDirectionalClassName } = this.state;\n    let content = (\n      <div ref={ this._resolveRef('_hostElement') } className={ 'ms-Callout-container' }>\n        <div\n          className={ css('ms-Callout', className, slideDirectionalClassName ? `ms-u-${ slideDirectionalClassName }` : '') }\n          style={ ((positions) ? positions.callout : OFF_SCREEN_POSITION) }\n          ref={ this._resolveRef('_calloutElement') }\n          >\n          { isBeakVisible && targetElement ? (<div className={ beakStyle }  style={ ((positions) ? positions.beak : BEAK_ORIGIN_POSITION) } />) : (null) }\n          <div className='ms-Callout-beakCurtain' />\n          <Popup\n            className='ms-Callout-main'\n            onDismiss={ (ev:any) => this.dismiss() }\n            shouldRestoreFocus={ true }>\n            { children }\n          </Popup>\n        </div>\n      </div>\n    );\n    return content;\n  }\n\n  public dismiss() {\n    let { onDismiss } = this.props;\n\n    if (onDismiss) {\n      onDismiss();\n    }\n  }\n\n  protected _dismissOnLostFocus(ev: Event) {\n    let { targetElement } = this.props;\n    let target = ev.target as HTMLElement;\n\n    if (ev.target !== this._targetWindow &&\n      this._hostElement &&\n      !elementContains(this._hostElement, target) &&\n      (!targetElement || !elementContains(targetElement, target))) {\n      this.dismiss();\n    }\n  }\n\n  @autobind\n  protected _setInitialFocus() {\n    if (this.props.setInitialFocus && !this._didSetInitialFocus && this.state.positions) {\n      this._didSetInitialFocus = true;\n      focusFirstChild(this._calloutElement);\n    }\n  }\n\n  @autobind\n  protected _onComponentDidMount() {\n    // This is added so the callout will dismiss when the window is scrolled\n    // but not when something inside the callout is scrolled.\n    this._events.on(this._targetWindow , 'scroll', this._dismissOnLostFocus, true);\n    this._events.on(this._targetWindow , 'resize', this.dismiss, true);\n    this._events.on(this._targetWindow , 'focus', this._dismissOnLostFocus, true);\n    this._events.on(this._targetWindow , 'click', this._dismissOnLostFocus, true);\n\n    if (this.props.onLayerMounted) {\n      this.props.onLayerMounted();\n    }\n\n    this._updatePosition();\n  }\n\n  private _updatePosition() {\n    let { positions } = this.state;\n    let hostElement: HTMLElement = this._hostElement;\n    let calloutElement: HTMLElement = this._calloutElement;\n\n    if (hostElement && calloutElement) {\n      let positionInfo: IPositionInfo = getRelativePositions(this.props, hostElement, calloutElement);\n\n      // Set the new position only when the positions are not exists or one of the new callout positions are different.\n      // The position should not change if the position is within 2 decimal places.\n      if ((!positions && positionInfo) ||\n        (positions && positionInfo && (positions.callout.top.toFixed(2) !== positionInfo.calloutPosition.top.toFixed(2) || positions.callout.left.toFixed(2) !== positionInfo.calloutPosition.left.toFixed(2)))) {\n\n        this.setState({\n          positions: {\n            callout: positionInfo.calloutPosition,\n            beak: positionInfo.beakPosition,\n          },\n          slideDirectionalClassName: positionInfo.directionalClassName\n        });\n      }\n    }\n  }\n}"],"sourceRoot":"/src"}