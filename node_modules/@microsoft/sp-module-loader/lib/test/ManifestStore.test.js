"use strict";
var ManifestStore_1 = require('../stores/ManifestStore');
require('es6-collections');
var assert = chai.assert;
describe('ManifestStore tests', function () {
    describe('Adding a built-in manifest', function () {
        var imageWebPartId = 'd1d91016-032f-456d-98a4-721247c305e8';
        var imageWebPartAlias = 'ImageWebpart';
        /* tslint:disable:no-any */
        var webpartManifest = {
            /* tslint:enable:no-any */
            manifestVersion: 2,
            componentType: 'WebPart',
            id: imageWebPartId,
            alias: imageWebPartAlias,
            version: '0.0.1',
            loaderConfig: {
                internalModuleBaseUrls: ['https://cdn.net/'],
                entryModuleId: 'main.bundle',
                scriptResources: {}
            },
            preconfiguredEntries: []
        };
        before(function () {
            ManifestStore_1.default.instance.importManifests([webpartManifest], true);
        });
        it('should get isInternal as true', function (done) {
            var fetchedManifest = ManifestStore_1.default.instance.getManifestById(imageWebPartId);
            assert.isTrue(fetchedManifest.isInternal);
            done();
        });
        it('should get alias back', function (done) {
            var fetchedManifest = ManifestStore_1.default.instance.getManifestById(imageWebPartId);
            assert.equal(fetchedManifest.alias, imageWebPartAlias);
            done();
        });
    });
    describe('Adding a custom manifest', function () {
        var customWebPartId = '00000000-0000-0000-0000-000000000000';
        var customWebPartAlias = 'CustomWebpart';
        /* tslint:disable:no-any */
        var webpartManifest = {
            /* tslint:enable:no-any */
            manifestVersion: 2,
            componentType: 'WebPart',
            id: customWebPartId,
            alias: customWebPartAlias,
            version: '0.0.1',
            loaderConfig: {
                internalModuleBaseUrls: ['https://cdn.net/'],
                entryModuleId: 'main.bundle',
                scriptResources: {}
            },
            preconfiguredEntries: []
        };
        before(function () {
            ManifestStore_1.default.instance.importManifests([webpartManifest], true);
        });
        it('should get isInternal as false', function (done) {
            var fetchedManifest = ManifestStore_1.default.instance.getManifestById(customWebPartId);
            assert.isFalse(fetchedManifest.isInternal);
            done();
        });
        it('should get alias back', function (done) {
            var fetchedManifest = ManifestStore_1.default.instance.getManifestById(customWebPartId);
            assert.equal(fetchedManifest.alias, customWebPartAlias);
            done();
        });
    });
});

//# sourceMappingURL=ManifestStore.test.js.map
