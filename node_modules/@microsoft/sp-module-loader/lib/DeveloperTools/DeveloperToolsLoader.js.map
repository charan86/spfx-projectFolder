{"version":3,"sources":["DeveloperTools/DeveloperToolsLoader.ts"],"names":[],"mappings":"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","file":"DeveloperTools/DeveloperToolsLoader.js","sourcesContent":["/**\r\n * @Copyright (c) Microsoft Corporation.  All rights reserved.\r\n *\r\n * @file DeveloperToolsLoader.ts\r\n */\r\n\r\nimport DeveloperTools from './DeveloperTools';\r\nimport { IDeveloperToolsTab } from './IDeveloperToolsTab';\r\nimport ModuleStore from './../stores/ModuleStore';\r\n\r\ninterface IDeveloperToolsWrapper {\r\n  default: typeof DeveloperTools;\r\n}\r\n\r\n// Ensure the load-themed-styles loader is in this chunk\r\nrequire('@microsoft/load-themed-styles');\r\n\r\nexport default class DeveloperToolsLoader {\r\n  private static _instance: DeveloperToolsLoader;\r\n\r\n  public static get instance(): DeveloperToolsLoader {\r\n    if (!DeveloperToolsLoader._instance) {\r\n      DeveloperToolsLoader._instance = new DeveloperToolsLoader();\r\n    }\r\n\r\n    return DeveloperToolsLoader._instance;\r\n  }\r\n\r\n  private _developerTools: DeveloperTools;\r\n\r\n  private _developerToolsTabsBacklog: IDeveloperToolsTab[] = [];\r\n\r\n  /**\r\n   * Registers a tab in the developer tools. The developer tools are invoked by pressing \"CTRL+SHIFT+~\".\r\n   *\r\n   * @param {developerToolsTab} The tab definition.\r\n   *\r\n   * @internal\r\n   */\r\n  public registerDeveloperToolsTab(developerToolsTab: IDeveloperToolsTab): void {\r\n    if (this._developerTools) {\r\n      this._developerTools.registerDeveloperToolsTab(developerToolsTab);\r\n    } else {\r\n      this._developerToolsTabsBacklog.push(developerToolsTab);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Shows/hides the developer tools panel.\r\n   *\r\n   * @internal\r\n   */\r\n  public toggleDeveloperTools(): void { // tslint:disable-line:export-name\r\n    if (this._developerTools) {\r\n      this._developerTools.toggleDeveloperTools();\r\n    } else {\r\n      // If we're building an NPM module, we need to make sure React, Flux, and React-DOM aren't bundled. Instead,\r\n      // we'll load them from node_modules.\r\n      if (NPM_BUILD) {\r\n        // Ensure the fake react, flux, and react-dom modules are included in this chunk\r\n        require.include('react');\r\n        require.include('flux');\r\n        require.include('react-dom');\r\n\r\n        /* tslint:disable:no-any */\r\n        const reactPromise: Promise<any> = ModuleStore.instance.npmLoadPackage('react');\r\n        const fluxPromise: Promise<any> = ModuleStore.instance.npmLoadPackage('flux');\r\n        const reactDomPromise: Promise<any> = ModuleStore.instance.npmLoadPackage('react-dom');\r\n        /* tslint:enable:no-any */\r\n\r\n        Promise.all([reactPromise, reactDomPromise, fluxPromise])\r\n          .then((results: any[]) => { // tslint:disable-line:no-any\r\n            /* tslint:disable:typedef */\r\n            const react = results[0];\r\n            const reactDom = results[1];\r\n            const flux = results[2];\r\n            /* tslint:enable:typedef */\r\n\r\n            this._injectReactFluxIntoCache(react, reactDom, flux);\r\n\r\n            this._loadDeveloperTools(!this._tryFillDevToolsFabric());\r\n          });\r\n      } else if (this._tryFillReactFlux()) {\r\n        this._loadDeveloperTools(!this._tryFillDevToolsFabric());\r\n      } else {\r\n        require.ensure(['react', 'react-dom', 'flux'], () => {\r\n          require.ensure(['./DeveloperToolsFabric'], () => {\r\n            require.ensure(['./DeveloperTools'], (require: ((path: string) => IDeveloperToolsWrapper)) => {\r\n              this._initializeDeveloperTools(require('./DeveloperTools').default);\r\n            }, 'developer-tools');\r\n          }, 'developer-tools-fabric');\r\n        }, 'react-flux');\r\n      }\r\n    }\r\n  }\r\n\r\n  private _tryFillReactFlux(): boolean {\r\n    /* tslint:disable:typedef */\r\n    const react = ModuleStore.instance.getModuleById('react');\r\n    const reactDom = ModuleStore.instance.getModuleById('react-dom');\r\n    const flux = ModuleStore.instance.getModuleById('flux');\r\n    /* tslint:enable:typedef */\r\n\r\n    if (react && flux && reactDom) {\r\n      this._injectReactFluxIntoCache(react, reactDom, flux);\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  private _tryFillDevToolsFabric(): boolean {\r\n    const fabric = ModuleStore.instance.getModuleById('office-ui-fabric-react'); // tslint:disable-line:typedef\r\n\r\n    if (fabric) {\r\n      const fabricId: number = require.resolveWeak('./DeveloperToolsFabric');\r\n      if (!require.cache[fabricId]) {\r\n        require.cache[fabricId] = {\r\n          exports: fabric\r\n        };\r\n      } else {\r\n        require.cache[fabricId].exports = fabric;\r\n      }\r\n\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  private _injectReactFluxIntoCache(react, reactDom, flux): void { // tslint:disable-line:typedef\r\n    const reactId: number = require.resolveWeak('react');\r\n    const reactDomId: number = require.resolveWeak('react-dom');\r\n    const fluxId: number = require.resolveWeak('flux');\r\n\r\n    // Inject react, react-dom, and flux into the module cache\r\n    if (!require.cache[reactId]) {\r\n      require.cache[reactId] = {\r\n        exports: react\r\n      };\r\n    } else {\r\n      require.cache[reactId].exports = react;\r\n    }\r\n\r\n    if (!require.cache[reactDomId]) {\r\n      require.cache[reactDomId] = {\r\n        exports: reactDom\r\n      };\r\n    } else {\r\n      require.cache[reactDomId].exports = reactDom;\r\n    }\r\n\r\n    if (!require.cache[fluxId]) {\r\n      require.cache[fluxId] = {\r\n        exports: flux\r\n      };\r\n    } else {\r\n      require.cache[fluxId].exports = flux;\r\n    }\r\n  }\r\n\r\n  private _loadDeveloperTools(loadFabric: boolean): void {\r\n    const loadDeveloperTools: () => void = () => {\r\n      __webpack_chunk_load__(/* developer-tools */3, (requireFn: ((id: number) => IDeveloperToolsWrapper)) => {\r\n        this._initializeDeveloperTools(requireFn(require.resolveWeak('./DeveloperTools')).default);\r\n      });\r\n    };\r\n\r\n    if (loadFabric) {\r\n      __webpack_chunk_load__(/* developer-tools-fabric */2, loadDeveloperTools);\r\n    } else {\r\n      loadDeveloperTools();\r\n    }\r\n  }\r\n\r\n  private _initializeDeveloperTools(developerToolsClass: typeof DeveloperTools): void  {\r\n    this._developerTools = developerToolsClass.instance;\r\n    this._developerTools.initialize();\r\n\r\n    this._developerToolsTabsBacklog.forEach((developerToolsTab: IDeveloperToolsTab) => {\r\n      this._developerTools.registerDeveloperToolsTab(developerToolsTab);\r\n    });\r\n\r\n    this._developerTools.showHideDeveloperTools(true);\r\n  }\r\n}"],"sourceRoot":"/src"}